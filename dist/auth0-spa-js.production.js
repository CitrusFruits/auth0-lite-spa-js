!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).createAuth0Client=t()}(this,(function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};function t(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}var n=function(){return(n=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function i(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n}function o(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))}function r(e,t){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}function s(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function a(e,t){for(var n=0,i=t.length,o=e.length;n<i;n++,o++)e[o]=t[n];return e}var c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function u(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function l(e,t){return e(t={exports:{}},t.exports),t.exports}var d=l((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){var e=this;this.locked=new Map,this.addToLocked=function(t,n){var i=e.locked.get(t);void 0===i?void 0===n?e.locked.set(t,[]):e.locked.set(t,[n]):void 0!==n&&(i.unshift(n),e.locked.set(t,i))},this.isLocked=function(t){return e.locked.has(t)},this.lock=function(t){return new Promise((function(n,i){e.isLocked(t)?e.addToLocked(t,n):(e.addToLocked(t),n())}))},this.unlock=function(t){var n=e.locked.get(t);if(void 0!==n&&0!==n.length){var i=n.pop();e.locked.set(t,n),void 0!==i&&setTimeout(i,0)}else e.locked.delete(t)}}return e.getInstance=function(){return void 0===e.instance&&(e.instance=new e),e.instance},e}();t.default=function(){return n.getInstance()}}));u(d);var h=u(l((function(e,t){var n=c&&c.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(s,a)}c((i=i.apply(e,t||[])).next())}))},i=c&&c.__generator||function(e,t){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var o="browser-tabs-lock-key";function r(e){return new Promise((function(t){return setTimeout(t,e)}))}function s(e){for(var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",n="",i=0;i<e;i++){n+=t[Math.floor(Math.random()*t.length)]}return n}var a=function(){function e(){this.acquiredIatSet=new Set,this.id=Date.now().toString()+s(15),this.acquireLock=this.acquireLock.bind(this),this.releaseLock=this.releaseLock.bind(this),this.releaseLock__private__=this.releaseLock__private__.bind(this),this.waitForSomethingToChange=this.waitForSomethingToChange.bind(this),this.refreshLockWhileAcquired=this.refreshLockWhileAcquired.bind(this),void 0===e.waiters&&(e.waiters=[])}return e.prototype.acquireLock=function(t,a){return void 0===a&&(a=5e3),n(this,void 0,void 0,(function(){var n,c,u,l,d,h;return i(this,(function(i){switch(i.label){case 0:n=Date.now()+s(4),c=Date.now()+a,u=o+"-"+t,l=window.localStorage,i.label=1;case 1:return Date.now()<c?[4,r(30)]:[3,8];case 2:return i.sent(),null!==l.getItem(u)?[3,5]:(d=this.id+"-"+t+"-"+n,[4,r(Math.floor(25*Math.random()))]);case 3:return i.sent(),l.setItem(u,JSON.stringify({id:this.id,iat:n,timeoutKey:d,timeAcquired:Date.now(),timeRefreshed:Date.now()})),[4,r(30)];case 4:return i.sent(),null!==(h=l.getItem(u))&&(h=JSON.parse(h)).id===this.id&&h.iat===n?(this.acquiredIatSet.add(n),this.refreshLockWhileAcquired(u,n),[2,!0]):[3,7];case 5:return e.lockCorrector(),[4,this.waitForSomethingToChange(c)];case 6:i.sent(),i.label=7;case 7:return n=Date.now()+s(4),[3,1];case 8:return[2,!1]}}))}))},e.prototype.refreshLockWhileAcquired=function(e,t){return n(this,void 0,void 0,(function(){var o=this;return i(this,(function(r){return setTimeout((function(){return n(o,void 0,void 0,(function(){var n,o;return i(this,(function(i){switch(i.label){case 0:return[4,d.default().lock(t)];case 1:return i.sent(),this.acquiredIatSet.has(t)?(n=window.localStorage,null===(o=n.getItem(e))?(d.default().unlock(t),[2]):((o=JSON.parse(o)).timeRefreshed=Date.now(),n.setItem(e,JSON.stringify(o)),d.default().unlock(t),this.refreshLockWhileAcquired(e,t),[2])):(d.default().unlock(t),[2])}}))}))}),1e3),[2]}))}))},e.prototype.waitForSomethingToChange=function(t){return n(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return[4,new Promise((function(n){var i=!1,o=Date.now(),r=!1;function s(){if(r||(window.removeEventListener("storage",s),e.removeFromWaiting(s),clearTimeout(a),r=!0),!i){i=!0;var t=50-(Date.now()-o);t>0?setTimeout(n,t):n()}}window.addEventListener("storage",s),e.addToWaiting(s);var a=setTimeout(s,Math.max(0,t-Date.now()))}))];case 1:return n.sent(),[2]}}))}))},e.addToWaiting=function(t){this.removeFromWaiting(t),void 0!==e.waiters&&e.waiters.push(t)},e.removeFromWaiting=function(t){void 0!==e.waiters&&(e.waiters=e.waiters.filter((function(e){return e!==t})))},e.notifyWaiters=function(){void 0!==e.waiters&&e.waiters.slice().forEach((function(e){return e()}))},e.prototype.releaseLock=function(e){return n(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.releaseLock__private__(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.releaseLock__private__=function(t){return n(this,void 0,void 0,(function(){var n,r,s;return i(this,(function(i){switch(i.label){case 0:return n=window.localStorage,r=o+"-"+t,null===(s=n.getItem(r))?[2]:(s=JSON.parse(s)).id!==this.id?[3,2]:[4,d.default().lock(s.iat)];case 1:i.sent(),this.acquiredIatSet.delete(s.iat),n.removeItem(r),d.default().unlock(s.iat),e.notifyWaiters(),i.label=2;case 2:return[2]}}))}))},e.lockCorrector=function(){for(var t=Date.now()-5e3,n=window.localStorage,i=Object.keys(n),r=!1,s=0;s<i.length;s++){var a=i[s];if(a.includes(o)){var c=n.getItem(a);null!==c&&(void 0===(c=JSON.parse(c)).timeRefreshed&&c.timeAcquired<t||void 0!==c.timeRefreshed&&c.timeRefreshed<t)&&(n.removeItem(a),r=!0)}}r&&e.notifyWaiters()},e.waiters=void 0,e}();t.default=a}))),p={timeoutInSeconds:60},f="memory",m=["login_required","consent_required","interaction_required","account_selection_required","access_denied"],v={name:"auth0-spa-js",version:"1.16.1"},y=function(e){function n(t,i){var o=e.call(this,i)||this;return o.error=t,o.error_description=i,Object.setPrototypeOf(o,n.prototype),o}return t(n,e),n.fromPayload=function(e){return new n(e.error,e.error_description)},n}(Error),g=function(e){function n(t,i,o,r){void 0===r&&(r=null);var s=e.call(this,t,i)||this;return s.state=o,s.appState=r,Object.setPrototypeOf(s,n.prototype),s}return t(n,e),n}(y),b=function(e){function n(){var t=e.call(this,"timeout","Timeout")||this;return Object.setPrototypeOf(t,n.prototype),t}return t(n,e),n}(y),w=function(e){function n(t){var i=e.call(this)||this;return i.popup=t,Object.setPrototypeOf(i,n.prototype),i}return t(n,e),n}(b),S=function(e){function n(t){var i=e.call(this,"cancelled","Popup closed")||this;return i.popup=t,Object.setPrototypeOf(i,n.prototype),i}return t(n,e),n}(y),I=function(e){return new Promise((function(t,n){var i,o=setInterval((function(){e.popup&&e.popup.closed&&(clearInterval(o),clearTimeout(r),window.removeEventListener("message",i,!1),n(new S(e.popup)))}),1e3),r=setTimeout((function(){clearInterval(o),n(new w(e.popup)),window.removeEventListener("message",i,!1)}),1e3*(e.timeoutInSeconds||60));i=function(s){if(s.data&&"authorization_response"===s.data.type){if(clearTimeout(r),clearInterval(o),window.removeEventListener("message",i,!1),e.popup.close(),s.data.response.error)return n(y.fromPayload(s.data.response));t(s.data.response)}},window.addEventListener("message",i)}))},k=function(){return window.crypto||window.msCrypto},_=function(){var e=k();return e.subtle||e.webkitSubtle},C=function(){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_~.",t="";return Array.from(k().getRandomValues(new Uint8Array(43))).forEach((function(n){return t+=e[n%e.length]})),t},K=function(e){return btoa(e)},T=function(e){return Object.keys(e).filter((function(t){return void 0!==e[t]})).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&")},U=function(e){return o(void 0,void 0,void 0,(function(){var t;return r(this,(function(n){switch(n.label){case 0:return t=_().digest({name:"SHA-256"},(new TextEncoder).encode(e)),window.msCrypto?[2,new Promise((function(e,n){t.oncomplete=function(t){e(t.target.result)},t.onerror=function(e){n(e.error)},t.onabort=function(){n("The digest operation was aborted")}}))]:[4,t];case 1:return[2,n.sent()]}}))}))},x=function(e){return function(e){return decodeURIComponent(atob(e).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))}(e.replace(/_/g,"/").replace(/-/g,"+"))},E=function(e){var t=new Uint8Array(e);return function(e){var t={"+":"-","/":"_","=":""};return e.replace(/[+/=]/g,(function(e){return t[e]}))}(window.btoa(String.fromCharCode.apply(String,a([],s(Array.from(t))))))};var Z=function(e,t){return o(void 0,void 0,void 0,(function(){var n,i;return r(this,(function(o){switch(o.label){case 0:return[4,(r=e,s=t,s=s||{},new Promise((function(e,t){var n=new XMLHttpRequest,i=[],o=[],a={},c=function(){return{ok:2==(n.status/100|0),statusText:n.statusText,status:n.status,url:n.responseURL,text:function(){return Promise.resolve(n.responseText)},json:function(){return Promise.resolve(n.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([n.response]))},clone:c,headers:{keys:function(){return i},entries:function(){return o},get:function(e){return a[e.toLowerCase()]},has:function(e){return e.toLowerCase()in a}}}};for(var u in n.open(s.method||"get",r,!0),n.onload=function(){n.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(function(e,t,n){i.push(t=t.toLowerCase()),o.push([t,n]),a[t]=a[t]?a[t]+","+n:n})),e(c())},n.onerror=t,n.withCredentials="include"==s.credentials,s.headers)n.setRequestHeader(u,s.headers[u]);n.send(s.body||null)})))];case 1:return n=o.sent(),i={ok:n.ok},[4,n.json()];case 2:return[2,(i.json=o.sent(),i)]}var r,s}))}))},W=function(e,t,n){return o(void 0,void 0,void 0,(function(){var i,o;return r(this,(function(r){return i=new AbortController,t.signal=i.signal,[2,Promise.race([Z(e,t),new Promise((function(e,t){o=setTimeout((function(){i.abort(),t(new Error("Timeout when executing 'fetch'"))}),n)}))]).finally((function(){clearTimeout(o)}))]}))}))},V=function(e,t,n,i,s,a){return o(void 0,void 0,void 0,(function(){return r(this,(function(o){return[2,(r={auth:{audience:t,scope:n},timeout:s,fetchUrl:e,fetchOptions:i},c=a,new Promise((function(e,t){var n=new MessageChannel;n.port1.onmessage=function(n){n.data.error?t(new Error(n.data.error)):e(n.data)},c.postMessage(r,[n.port2])})))];var r,c}))}))},R=function(e,t,n,i,s,a){return void 0===a&&(a=1e4),o(void 0,void 0,void 0,(function(){return r(this,(function(o){return s?[2,V(e,t,n,i,a,s)]:[2,W(e,i,a)]}))}))};function X(e,t,n,s,a,c){return o(this,void 0,void 0,(function(){var o,u,l,d,h,p,f,m;return r(this,(function(r){switch(r.label){case 0:o=null,l=0,r.label=1;case 1:if(!(l<3))return[3,6];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,R(e,n,s,a,c,t)];case 3:return u=r.sent(),o=null,[3,6];case 4:return d=r.sent(),o=d,[3,5];case 5:return l++,[3,1];case 6:if(o)throw o.message=o.message||"Failed to fetch",o;if(h=u.json,p=h.error,f=h.error_description,m=i(h,["error","error_description"]),!u.ok)throw new y(p||"request_error",f||"HTTP error. Unable to fetch "+e);return[2,m]}}))}))}function L(e,t){var n=e.baseUrl,s=e.timeout,a=e.audience,c=e.scope,u=e.auth0Client,l=i(e,["baseUrl","timeout","audience","scope","auth0Client"]);return o(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,X(n+"/oauth/token",s,a||"default",c,{method:"POST",body:JSON.stringify(l),headers:{"Content-type":"application/json","Auth0-Client":btoa(JSON.stringify(u||v))}},t)];case 1:return[2,e.sent()]}}))}))}var F=function(e){return Array.from(new Set(e))},J=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return F(e.join(" ").trim().split(/\s+/)).join(" ")},O="@@auth0spajs@@",z=function(){function e(e,t){void 0===t&&(t=O),this.prefix=t,this.client_id=e.client_id,this.scope=e.scope,this.audience=e.audience}return e.prototype.toKey=function(){return this.prefix+"::"+this.client_id+"::"+this.audience+"::"+this.scope},e.fromKey=function(t){var n=s(t.split("::"),4),i=n[0],o=n[1],r=n[2];return new e({client_id:o,scope:n[3],audience:r},i)},e.fromCacheEntry=function(t){return new e({scope:t.scope,audience:t.audience,client_id:t.client_id})},e}(),G=function(){function e(){}return e.prototype.set=function(e,t){localStorage.setItem(e,JSON.stringify(t))},e.prototype.get=function(e){var t=window.localStorage.getItem(e);if(t)try{return JSON.parse(t)}catch(e){return}},e.prototype.remove=function(e){localStorage.removeItem(e)},e.prototype.allKeys=function(){return Object.keys(window.localStorage).filter((function(e){return e.startsWith(O)}))},e}(),N=function(){var e;this.enclosedCache=(e={},{set:function(t,n){e[t]=n},get:function(t){var n=e[t];if(n)return n},remove:function(t){delete e[t]},allKeys:function(){return Object.keys(e)}})},Y=function(){function e(e,t){this.cache=e,this.clientId=t,this.manifestKey=this.createManifestKeyFrom(t)}return e.prototype.add=function(e){var t;return o(this,void 0,void 0,(function(){var n,i;return r(this,(function(o){switch(o.label){case 0:return i=Set.bind,[4,this.cache.get(this.manifestKey)];case 1:return(n=new(i.apply(Set,[void 0,(null===(t=o.sent())||void 0===t?void 0:t.keys)||[]]))).add(e),[4,this.cache.set(this.manifestKey,{keys:a([],s(n))})];case 2:return o.sent(),[2]}}))}))},e.prototype.remove=function(e){return o(this,void 0,void 0,(function(){var t,n;return r(this,(function(i){switch(i.label){case 0:return[4,this.cache.get(this.manifestKey)];case 1:return(t=i.sent())?((n=new Set(t.keys)).delete(e),n.size>0?[4,this.cache.set(this.manifestKey,{keys:a([],s(n))})]:[3,3]):[3,5];case 2:return[2,i.sent()];case 3:return[4,this.cache.remove(this.manifestKey)];case 4:return[2,i.sent()];case 5:return[2]}}))}))},e.prototype.get=function(){return this.cache.get(this.manifestKey)},e.prototype.clear=function(){return this.cache.remove(this.manifestKey)},e.prototype.createManifestKeyFrom=function(e){return"@@auth0spajs@@::"+e},e}(),P=function(){function e(e,t){this.cache=e,e.allKeys||(this.keyManifest=new Y(this.cache,t))}return e.prototype.get=function(e,t){var n;return void 0===t&&(t=0),o(this,void 0,void 0,(function(){var i,o,s,a;return r(this,(function(r){switch(r.label){case 0:return[4,this.cache.get(e.toKey())];case 1:return(i=r.sent())?[3,4]:[4,this.getCacheKeys()];case 2:return(o=r.sent())?(s=this.matchExistingCacheKey(e,o),[4,this.cache.get(s)]):[2];case 3:i=r.sent(),r.label=4;case 4:return i?(a=Math.floor(Date.now()/1e3),i.expiresAt-t<a?i.body.refresh_token?(i.body={refresh_token:i.body.refresh_token},[4,this.cache.set(e.toKey(),i)]):[3,6]:[3,9]):[2];case 5:return r.sent(),[2,i.body];case 6:return[4,this.cache.remove(e.toKey())];case 7:return r.sent(),[4,null===(n=this.keyManifest)||void 0===n?void 0:n.remove(e.toKey())];case 8:return r.sent(),[2];case 9:return[2,i.body]}}))}))},e.prototype.set=function(e){var t;return o(this,void 0,void 0,(function(){var n,i;return r(this,(function(o){switch(o.label){case 0:return n=new z({client_id:e.client_id,scope:e.scope,audience:e.audience}),i=this.wrapCacheEntry(e),[4,this.cache.set(n.toKey(),i)];case 1:return o.sent(),[4,null===(t=this.keyManifest)||void 0===t?void 0:t.add(n.toKey())];case 2:return o.sent(),[2]}}))}))},e.prototype.clear=function(){var e;return o(this,void 0,void 0,(function(){var t,n=this;return r(this,(function(i){switch(i.label){case 0:return[4,this.getCacheKeys()];case 1:return(t=i.sent())?(t.forEach((function(e){return o(n,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.cache.remove(e)];case 1:return t.sent(),[2]}}))}))})),[4,null===(e=this.keyManifest)||void 0===e?void 0:e.clear()]):[2];case 2:return i.sent(),[2]}}))}))},e.prototype.clearSync=function(){var e=this,t=this.cache.allKeys();t&&t.forEach((function(t){e.cache.remove(t)}))},e.prototype.wrapCacheEntry=function(e){var t=Math.floor(Date.now()/1e3)+e.expires_in;return{body:e,expiresAt:Math.min(t,e.decodedToken.claims.exp)}},e.prototype.getCacheKeys=function(){var e;return o(this,void 0,void 0,(function(){var t;return r(this,(function(n){switch(n.label){case 0:return this.keyManifest?[4,this.keyManifest.get()]:[3,2];case 1:return t=null===(e=n.sent())||void 0===e?void 0:e.keys,[3,4];case 2:return[4,this.cache.allKeys()];case 3:t=n.sent(),n.label=4;case 4:return[2,t]}}))}))},e.prototype.matchExistingCacheKey=function(e,t){return t.filter((function(t){var n=z.fromKey(t),i=new Set(n.scope&&n.scope.split(" ")),o=e.scope.split(" "),r=n.scope&&o.reduce((function(e,t){return e&&i.has(t)}),!0);return n.prefix===O&&n.client_id===e.client_id&&n.audience===e.audience&&r}))[0]},e}(),B="a0.spajs.txs",H=function(){function e(e){this.storage=e,this.transaction=this.storage.get(B)}return e.prototype.create=function(e){this.transaction=e,this.storage.save(B,e,{daysUntilExpire:1})},e.prototype.get=function(){return this.transaction},e.prototype.remove=function(){delete this.transaction,this.storage.remove(B)},e}(),M=function(e){return"number"==typeof e},j=["iss","aud","exp","nbf","iat","jti","azp","nonce","auth_time","at_hash","c_hash","acr","amr","sub_jwk","cnf","sip_from_tag","sip_date","sip_callid","sip_cseq_num","sip_via_branch","orig","dest","mky","events","toe","txn","rph","sid","vot","vtm"],A=function(e){if(!e.id_token)throw new Error("ID token is required but missing");var t=function(e){var t=e.split("."),n=s(t,3),i=n[0],o=n[1],r=n[2];if(3!==t.length||!i||!o||!r)throw new Error("ID token could not be decoded");var a=JSON.parse(x(o)),c={__raw:e},u={};return Object.keys(a).forEach((function(e){c[e]=a[e],j.includes(e)||(u[e]=a[e])})),{encoded:{header:i,payload:o,signature:r},header:JSON.parse(x(i)),claims:c,user:u}}(e.id_token);if(!t.claims.iss)throw new Error("Issuer (iss) claim must be a string present in the ID token");if(t.claims.iss!==e.iss)throw new Error('Issuer (iss) claim mismatch in the ID token; expected "'+e.iss+'", found "'+t.claims.iss+'"');if(!t.user.sub)throw new Error("Subject (sub) claim must be a string present in the ID token");if("RS256"!==t.header.alg)throw new Error('Signature algorithm of "'+t.header.alg+'" is not supported. Expected the ID token to be signed with "RS256".');if(!t.claims.aud||"string"!=typeof t.claims.aud&&!Array.isArray(t.claims.aud))throw new Error("Audience (aud) claim must be a string or array of strings present in the ID token");if(Array.isArray(t.claims.aud)){if(!t.claims.aud.includes(e.aud))throw new Error('Audience (aud) claim mismatch in the ID token; expected "'+e.aud+'" but was not one of "'+t.claims.aud.join(", ")+'"');if(t.claims.aud.length>1){if(!t.claims.azp)throw new Error("Authorized Party (azp) claim must be a string present in the ID token when Audience (aud) claim has multiple values");if(t.claims.azp!==e.aud)throw new Error('Authorized Party (azp) claim mismatch in the ID token; expected "'+e.aud+'", found "'+t.claims.azp+'"')}}else if(t.claims.aud!==e.aud)throw new Error('Audience (aud) claim mismatch in the ID token; expected "'+e.aud+'" but found "'+t.claims.aud+'"');if(e.nonce){if(!t.claims.nonce)throw new Error("Nonce (nonce) claim must be a string present in the ID token");if(t.claims.nonce!==e.nonce)throw new Error('Nonce (nonce) claim mismatch in the ID token; expected "'+e.nonce+'", found "'+t.claims.nonce+'"')}if(e.max_age&&!M(t.claims.auth_time))throw new Error("Authentication Time (auth_time) claim must be a number present in the ID token when Max Age (max_age) is specified");if(!M(t.claims.exp))throw new Error("Expiration Time (exp) claim must be a number present in the ID token");if(!M(t.claims.iat))throw new Error("Issued At (iat) claim must be a number present in the ID token");var n=e.leeway||60,i=new Date(Date.now()),o=new Date(0),r=new Date(0),a=new Date(0);if(a.setUTCSeconds(parseInt(t.claims.auth_time)+e.max_age+n),o.setUTCSeconds(t.claims.exp+n),r.setUTCSeconds(t.claims.nbf-n),i>o)throw new Error("Expiration Time (exp) claim error in the ID token; current time ("+i+") is after expiration time ("+o+")");if(M(t.claims.nbf)&&i<r)throw new Error("Not Before time (nbf) claim in the ID token indicates that this token can't be used just yet. Currrent time ("+i+") is before "+r);if(M(t.claims.auth_time)&&i>a)throw new Error("Authentication Time (auth_time) claim in the ID token indicates that too much time has passed since the last end-user authentication. Currrent time ("+i+") is after last auth at "+a);if(e.organizationId){if(!t.claims.org_id)throw new Error("Organization ID (org_id) claim must be a string present in the ID token");if(e.organizationId!==t.claims.org_id)throw new Error('Organization ID (org_id) claim mismatch in the ID token; expected "'+e.organizationId+'", found "'+t.claims.org_id+'"')}return t},D=l((function(e,t){var n=c&&c.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function i(e,t){if(!t)return"";var n="; "+e;return!0===t?n:n+"="+t}function o(e,t,n){return encodeURIComponent(e).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/\(/g,"%28").replace(/\)/g,"%29")+"="+encodeURIComponent(t).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent)+function(e){if("number"==typeof e.expires){var t=new Date;t.setMilliseconds(t.getMilliseconds()+864e5*e.expires),e.expires=t}return i("Expires",e.expires?e.expires.toUTCString():"")+i("Domain",e.domain)+i("Path",e.path)+i("Secure",e.secure)+i("SameSite",e.sameSite)}(n)}function r(e){for(var t={},n=e?e.split("; "):[],i=/(%[\dA-F]{2})+/gi,o=0;o<n.length;o++){var r=n[o].split("="),s=r.slice(1).join("=");'"'===s.charAt(0)&&(s=s.slice(1,-1));try{t[r[0].replace(i,decodeURIComponent)]=s.replace(i,decodeURIComponent)}catch(e){}}return t}function s(){return r(document.cookie)}function a(e,t,i){document.cookie=o(e,t,n({path:"/"},i))}t.__esModule=!0,t.encode=o,t.parse=r,t.getAll=s,t.get=function(e){return s()[e]},t.set=a,t.remove=function(e,t){a(e,"",n(n({},t),{expires:-1}))}}));u(D),D.encode,D.parse,D.getAll;var q=D.get,Q=D.set,$=D.remove,ee={get:function(e){var t=q(e);if(void 0!==t)return JSON.parse(t)},save:function(e,t,n){var i={};"https:"===window.location.protocol&&(i={secure:!0,sameSite:"none"}),i.expires=n.daysUntilExpire,Q(e,JSON.stringify(t),i)},remove:function(e){$(e)}},te={get:function(e){var t=ee.get(e);return t||ee.get("_legacy_"+e)},save:function(e,t,n){var i={};"https:"===window.location.protocol&&(i={secure:!0}),i.expires=n.daysUntilExpire,Q("_legacy_"+e,JSON.stringify(t),i),ee.save(e,t,n)},remove:function(e){ee.remove(e),ee.remove("_legacy_"+e)}},ne={get:function(e){if("undefined"!=typeof sessionStorage){var t=sessionStorage.getItem(e);if(void 0!==t)return JSON.parse(t)}},save:function(e,t){sessionStorage.setItem(e,JSON.stringify(t))},remove:function(e){sessionStorage.removeItem(e)}};function ie(e,t,n){var i=void 0===t?null:t,o=function(e,t){var n=atob(e);if(t){for(var i=new Uint8Array(n.length),o=0,r=n.length;o<r;++o)i[o]=n.charCodeAt(o);return String.fromCharCode.apply(null,new Uint16Array(i.buffer))}return n}(e,void 0!==n&&n),r=o.indexOf("\n",10)+1,s=o.substring(r)+(i?"//# sourceMappingURL="+i:""),a=new Blob([s],{type:"application/javascript"});return URL.createObjectURL(a)}var oe,re,se,ae,ce=(oe="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwohZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7Ci8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgogICAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uCgogICAgUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55CiAgICBwdXJwb3NlIHdpdGggb3Igd2l0aG91dCBmZWUgaXMgaGVyZWJ5IGdyYW50ZWQuCgogICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEgKICAgIFJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWQogICAgQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULAogICAgSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NCiAgICBMT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUgogICAgT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUgogICAgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4KICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovdmFyIGU9ZnVuY3Rpb24oKXtyZXR1cm4oZT1PYmplY3QuYXNzaWdufHxmdW5jdGlvbihlKXtmb3IodmFyIHIsdD0xLG49YXJndW1lbnRzLmxlbmd0aDt0PG47dCsrKWZvcih2YXIgbyBpbiByPWFyZ3VtZW50c1t0XSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocixvKSYmKGVbb109cltvXSk7cmV0dXJuIGV9KS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9O2Z1bmN0aW9uIHIoZSxyLHQsbil7cmV0dXJuIG5ldyh0fHwodD1Qcm9taXNlKSkoKGZ1bmN0aW9uKG8scyl7ZnVuY3Rpb24gYShlKXt0cnl7dShuLm5leHQoZSkpfWNhdGNoKGUpe3MoZSl9fWZ1bmN0aW9uIGkoZSl7dHJ5e3Uobi50aHJvdyhlKSl9Y2F0Y2goZSl7cyhlKX19ZnVuY3Rpb24gdShlKXt2YXIgcjtlLmRvbmU/byhlLnZhbHVlKToocj1lLnZhbHVlLHIgaW5zdGFuY2VvZiB0P3I6bmV3IHQoKGZ1bmN0aW9uKGUpe2Uocil9KSkpLnRoZW4oYSxpKX11KChuPW4uYXBwbHkoZSxyfHxbXSkpLm5leHQoKSl9KSl9ZnVuY3Rpb24gdChlLHIpe3ZhciB0LG4sbyxzLGE9e2xhYmVsOjAsc2VudDpmdW5jdGlvbigpe2lmKDEmb1swXSl0aHJvdyBvWzFdO3JldHVybiBvWzFdfSx0cnlzOltdLG9wczpbXX07cmV0dXJuIHM9e25leHQ6aSgwKSx0aHJvdzppKDEpLHJldHVybjppKDIpfSwiZnVuY3Rpb24iPT10eXBlb2YgU3ltYm9sJiYoc1tTeW1ib2wuaXRlcmF0b3JdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KSxzO2Z1bmN0aW9uIGkocyl7cmV0dXJuIGZ1bmN0aW9uKGkpe3JldHVybiBmdW5jdGlvbihzKXtpZih0KXRocm93IG5ldyBUeXBlRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy4iKTtmb3IoO2E7KXRyeXtpZih0PTEsbiYmKG89MiZzWzBdP24ucmV0dXJuOnNbMF0/bi50aHJvd3x8KChvPW4ucmV0dXJuKSYmby5jYWxsKG4pLDApOm4ubmV4dCkmJiEobz1vLmNhbGwobixzWzFdKSkuZG9uZSlyZXR1cm4gbztzd2l0Y2gobj0wLG8mJihzPVsyJnNbMF0sby52YWx1ZV0pLHNbMF0pe2Nhc2UgMDpjYXNlIDE6bz1zO2JyZWFrO2Nhc2UgNDpyZXR1cm4gYS5sYWJlbCsrLHt2YWx1ZTpzWzFdLGRvbmU6ITF9O2Nhc2UgNTphLmxhYmVsKyssbj1zWzFdLHM9WzBdO2NvbnRpbnVlO2Nhc2UgNzpzPWEub3BzLnBvcCgpLGEudHJ5cy5wb3AoKTtjb250aW51ZTtkZWZhdWx0OmlmKCEobz1hLnRyeXMsKG89by5sZW5ndGg+MCYmb1tvLmxlbmd0aC0xXSl8fDYhPT1zWzBdJiYyIT09c1swXSkpe2E9MDtjb250aW51ZX1pZigzPT09c1swXSYmKCFvfHxzWzFdPm9bMF0mJnNbMV08b1szXSkpe2EubGFiZWw9c1sxXTticmVha31pZig2PT09c1swXSYmYS5sYWJlbDxvWzFdKXthLmxhYmVsPW9bMV0sbz1zO2JyZWFrfWlmKG8mJmEubGFiZWw8b1syXSl7YS5sYWJlbD1vWzJdLGEub3BzLnB1c2gocyk7YnJlYWt9b1syXSYmYS5vcHMucG9wKCksYS50cnlzLnBvcCgpO2NvbnRpbnVlfXM9ci5jYWxsKGUsYSl9Y2F0Y2goZSl7cz1bNixlXSxuPTB9ZmluYWxseXt0PW89MH1pZig1JnNbMF0pdGhyb3cgc1sxXTtyZXR1cm57dmFsdWU6c1swXT9zWzFdOnZvaWQgMCxkb25lOiEwfX0oW3MsaV0pfX19dmFyIG49e30sbz1mdW5jdGlvbihlLHIpe3JldHVybiBlKyJ8IityfTthZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwoZnVuY3Rpb24ocyl7dmFyIGE9cy5kYXRhLGk9YS50aW1lb3V0LHU9YS5hdXRoLGM9YS5mZXRjaFVybCxsPWEuZmV0Y2hPcHRpb25zLGY9ZnVuY3Rpb24oZSxyKXt2YXIgdD0iZnVuY3Rpb24iPT10eXBlb2YgU3ltYm9sJiZlW1N5bWJvbC5pdGVyYXRvcl07aWYoIXQpcmV0dXJuIGU7dmFyIG4sbyxzPXQuY2FsbChlKSxhPVtdO3RyeXtmb3IoOyh2b2lkIDA9PT1yfHxyLS0gPjApJiYhKG49cy5uZXh0KCkpLmRvbmU7KWEucHVzaChuLnZhbHVlKX1jYXRjaChlKXtvPXtlcnJvcjplfX1maW5hbGx5e3RyeXtuJiYhbi5kb25lJiYodD1zLnJldHVybikmJnQuY2FsbChzKX1maW5hbGx5e2lmKG8pdGhyb3cgby5lcnJvcn19cmV0dXJuIGF9KHMucG9ydHMsMSlbMF07cmV0dXJuIHIodm9pZCAwLHZvaWQgMCx2b2lkIDAsKGZ1bmN0aW9uKCl7dmFyIHIscyxhLGgscCx5LGIsdixkLHc7cmV0dXJuIHQodGhpcywoZnVuY3Rpb24odCl7c3dpdGNoKHQubGFiZWwpe2Nhc2UgMDphPShzPXV8fHt9KS5hdWRpZW5jZSxoPXMuc2NvcGUsdC5sYWJlbD0xO2Nhc2UgMTppZih0LnRyeXMucHVzaChbMSw3LCw4XSksIShwPUpTT04ucGFyc2UobC5ib2R5KSkucmVmcmVzaF90b2tlbiYmInJlZnJlc2hfdG9rZW4iPT09cC5ncmFudF90eXBlKXtpZighKHk9ZnVuY3Rpb24oZSxyKXtyZXR1cm4gbltvKGUscildfShhLGgpKSl0aHJvdyBuZXcgRXJyb3IoIlRoZSB3ZWIgd29ya2VyIGlzIG1pc3NpbmcgdGhlIHJlZnJlc2ggdG9rZW4iKTtsLmJvZHk9SlNPTi5zdHJpbmdpZnkoZShlKHt9LHApLHtyZWZyZXNoX3Rva2VuOnl9KSl9Yj12b2lkIDAsImZ1bmN0aW9uIj09dHlwZW9mIEFib3J0Q29udHJvbGxlciYmKGI9bmV3IEFib3J0Q29udHJvbGxlcixsLnNpZ25hbD1iLnNpZ25hbCksdj12b2lkIDAsdC5sYWJlbD0yO2Nhc2UgMjpyZXR1cm4gdC50cnlzLnB1c2goWzIsNCwsNV0pLFs0LFByb21pc2UucmFjZShbKGc9aSxuZXcgUHJvbWlzZSgoZnVuY3Rpb24oZSl7cmV0dXJuIHNldFRpbWVvdXQoZSxnKX0pKSksZmV0Y2goYyxlKHt9LGwpKV0pXTtjYXNlIDM6cmV0dXJuIHY9dC5zZW50KCksWzMsNV07Y2FzZSA0OnJldHVybiBkPXQuc2VudCgpLGYucG9zdE1lc3NhZ2Uoe2Vycm9yOmQubWVzc2FnZX0pLFsyXTtjYXNlIDU6cmV0dXJuIHY/WzQsdi5qc29uKCldOihiJiZiLmFib3J0KCksZi5wb3N0TWVzc2FnZSh7ZXJyb3I6IlRpbWVvdXQgd2hlbiBleGVjdXRpbmcgJ2ZldGNoJyJ9KSxbMl0pO2Nhc2UgNjpyZXR1cm4ocj10LnNlbnQoKSkucmVmcmVzaF90b2tlbj8oZnVuY3Rpb24oZSxyLHQpe25bbyhyLHQpXT1lfShyLnJlZnJlc2hfdG9rZW4sYSxoKSxkZWxldGUgci5yZWZyZXNoX3Rva2VuKTpmdW5jdGlvbihlLHIpe2RlbGV0ZSBuW28oZSxyKV19KGEsaCksZi5wb3N0TWVzc2FnZSh7b2s6di5vayxqc29uOnJ9KSxbMyw4XTtjYXNlIDc6cmV0dXJuIHc9dC5zZW50KCksZi5wb3N0TWVzc2FnZSh7b2s6ITEsanNvbjp7ZXJyb3JfZGVzY3JpcHRpb246dy5tZXNzYWdlfX0pLFszLDhdO2Nhc2UgODpyZXR1cm5bMl19dmFyIGd9KSl9KSl9KSl9KCk7Cgo=",re=null,se=!1,function(e){return ae=ae||ie(oe,re,se),new Worker(ae,e)}),ue={},le=new h,de="auth0.lock.getTokenSilently",he={memory:function(){return(new N).enclosedCache},localstorage:function(){return new G}},pe=function(e){return he[e]},fe=function(){return!/Trident.*rv:11\.0/.test(navigator.userAgent)},me=function(){function e(e){var t,n,o;if(this.options=e,"undefined"!=typeof window&&function(){if(!k())throw new Error("For security reasons, `window.crypto` is required to run `auth0-spa-js`.");if(void 0===_())throw new Error("\n      auth0-spa-js must run on a secure origin. See https://github.com/auth0/auth0-spa-js/blob/master/FAQ.md#why-do-i-get-auth0-spa-js-must-run-on-a-secure-origin for more information.\n    ")}(),e.cache&&e.cacheLocation&&console.warn("Both `cache` and `cacheLocation` options have been specified in the Auth0Client configuration; ignoring `cacheLocation` and using `cache`."),e.cache)o=e.cache;else{if(this.cacheLocation=e.cacheLocation||f,!pe(this.cacheLocation))throw new Error('Invalid cache location "'+this.cacheLocation+'"');o=pe(this.cacheLocation)()}this.cookieStorage=!1===e.legacySameSiteCookie?ee:te,this.sessionCheckExpiryDays=e.sessionCheckExpiryDays||1;var r,s,a=e.useCookiesForTransactions?this.cookieStorage:ne;this.scope=this.options.scope,this.transactionManager=new H(a),this.cacheManager=new P(o,this.options.client_id),this.domainUrl="https://"+this.options.domain,this.tokenIssuer=(r=this.options.issuer,s=this.domainUrl,r?r.startsWith("https://")?r:"https://"+r+"/":s+"/"),this.defaultScope=J("openid",void 0!==(null===(n=null===(t=this.options)||void 0===t?void 0:t.advancedOptions)||void 0===n?void 0:n.defaultScope)?this.options.advancedOptions.defaultScope:"openid profile email"),this.options.useRefreshTokens&&(this.scope=J(this.scope,"offline_access")),"undefined"!=typeof window&&window.Worker&&this.options.useRefreshTokens&&this.cacheLocation===f&&fe()&&(this.worker=new ce),this.customOptions=function(e){return e.advancedOptions,e.audience,e.auth0Client,e.authorizeTimeoutInSeconds,e.cacheLocation,e.client_id,e.domain,e.issuer,e.leeway,e.max_age,e.redirect_uri,e.scope,e.useRefreshTokens,i(e,["advancedOptions","audience","auth0Client","authorizeTimeoutInSeconds","cacheLocation","client_id","domain","issuer","leeway","max_age","redirect_uri","scope","useRefreshTokens"])}(e)}return e.prototype._url=function(e){var t=encodeURIComponent(btoa(JSON.stringify(this.options.auth0Client||v)));return""+this.domainUrl+e+"&auth0Client="+t},e.prototype._getParams=function(e,t,o,r,s){var a=this.options;a.domain,a.leeway,a.useRefreshTokens,a.useCookiesForTransactions,a.auth0Client,a.cacheLocation,a.advancedOptions;var c=i(a,["domain","leeway","useRefreshTokens","useCookiesForTransactions","auth0Client","cacheLocation","advancedOptions"]);return n(n(n({},c),e),{scope:J(this.defaultScope,this.scope,e.scope),response_type:"code",response_mode:"query",state:t,nonce:o,redirect_uri:s||this.options.redirect_uri,code_challenge:r,code_challenge_method:"S256"})},e.prototype._authorizeUrl=function(e){return this._url("/authorize?"+T(e))},e.prototype._verifyIdToken=function(e,t,n){return A({iss:this.tokenIssuer,aud:this.options.client_id,id_token:e,nonce:t,organizationId:n,leeway:this.options.leeway,max_age:this._parseNumber(this.options.max_age)})},e.prototype._parseNumber=function(e){return"string"!=typeof e?e:parseInt(e,10)||void 0},e.prototype.buildAuthorizeUrl=function(e){return void 0===e&&(e={}),o(this,void 0,void 0,(function(){var t,o,s,a,c,u,l,d,h,p,f,m;return r(this,(function(r){switch(r.label){case 0:return t=e.redirect_uri,o=e.appState,s=i(e,["redirect_uri","appState"]),a=K(C()),c=K(C()),u=C(),[4,U(u)];case 1:return l=r.sent(),d=E(l),h=e.fragment?"#"+e.fragment:"",p=this._getParams(s,a,c,d,t),f=this._authorizeUrl(p),m=e.organization||this.options.organization,this.transactionManager.create(n({nonce:c,code_verifier:u,appState:o,scope:p.scope,audience:p.audience||"default",redirect_uri:p.redirect_uri},m&&{organizationId:m})),[2,f+h]}}))}))},e.prototype.loginWithPopup=function(e,t){return o(this,void 0,void 0,(function(){var o,s,a,c,u,l,d,h,p,f,m,v,y;return r(this,(function(r){switch(r.label){case 0:return e=e||{},(t=t||{}).popup||(t.popup=function(e){var t=window.screenX+(window.innerWidth-400)/2,n=window.screenY+(window.innerHeight-600)/2;return window.open(e,"auth0:authorize:popup","left="+t+",top="+n+",width=400,height=600,resizable,scrollbars=yes,status=1")}("")),o=i(e,[]),s=K(C()),a=K(C()),c=C(),[4,U(c)];case 1:return u=r.sent(),l=E(u),d=this._getParams(o,s,a,l,this.options.redirect_uri||window.location.origin),h=this._authorizeUrl(n(n({},d),{response_mode:"web_message"})),t.popup.location.href=h,[4,I(n(n({},t),{timeoutInSeconds:t.timeoutInSeconds||this.options.authorizeTimeoutInSeconds||60}))];case 2:if(p=r.sent(),s!==p.state)throw new Error("Invalid state");return[4,L({audience:d.audience,scope:d.scope,baseUrl:this.domainUrl,client_id:this.options.client_id,code_verifier:c,code:p.code,grant_type:"authorization_code",redirect_uri:d.redirect_uri,auth0Client:this.options.auth0Client},this.worker)];case 3:return f=r.sent(),m=e.organization||this.options.organization,v=this._verifyIdToken(f.id_token,a,m),y=n(n({},f),{decodedToken:v,scope:d.scope,audience:d.audience||"default",client_id:this.options.client_id}),[4,this.cacheManager.set(y)];case 4:return r.sent(),this.cookieStorage.save("auth0.is.authenticated",!0,{daysUntilExpire:this.sessionCheckExpiryDays}),[2]}}))}))},e.prototype.getUser=function(e){return void 0===e&&(e={}),o(this,void 0,void 0,(function(){var t,n,i;return r(this,(function(o){switch(o.label){case 0:return t=e.audience||this.options.audience||"default",n=J(this.defaultScope,this.scope,e.scope),[4,this.cacheManager.get(new z({client_id:this.options.client_id,audience:t,scope:n}))];case 1:return[2,(i=o.sent())&&i.decodedToken&&i.decodedToken.user]}}))}))},e.prototype.getIdTokenClaims=function(e){return void 0===e&&(e={}),o(this,void 0,void 0,(function(){var t,n,i;return r(this,(function(o){switch(o.label){case 0:return t=e.audience||this.options.audience||"default",n=J(this.defaultScope,this.scope,e.scope),[4,this.cacheManager.get(new z({client_id:this.options.client_id,audience:t,scope:n}))];case 1:return[2,(i=o.sent())&&i.decodedToken&&i.decodedToken.claims]}}))}))},e.prototype.loginWithRedirect=function(e){return void 0===e&&(e={}),o(this,void 0,void 0,(function(){var t,n,o;return r(this,(function(r){switch(r.label){case 0:return t=e.redirectMethod,n=i(e,["redirectMethod"]),[4,this.buildAuthorizeUrl(n)];case 1:return o=r.sent(),window.location[t||"assign"](o),[2]}}))}))},e.prototype.handleRedirectCallback=function(e){return void 0===e&&(e=window.location.href),o(this,void 0,void 0,(function(){var t,i,o,a,c,u,l,d,h,p,f;return r(this,(function(r){switch(r.label){case 0:if(0===(t=e.split("?").slice(1)).length)throw new Error("There are no query params available for parsing.");if(i=function(e){e.indexOf("#")>-1&&(e=e.substr(0,e.indexOf("#")));var t=e.split("&"),i={};return t.forEach((function(e){var t=s(e.split("="),2),n=t[0],o=t[1];i[n]=decodeURIComponent(o)})),n(n({},i),{expires_in:parseInt(i.expires_in)})}(t.join("")),o=i.state,a=i.code,c=i.error,u=i.error_description,!(l=this.transactionManager.get())||!l.code_verifier)throw new Error("Invalid state");if(this.transactionManager.remove(),c)throw new g(c,u,o,l.appState);return d={audience:l.audience,scope:l.scope,baseUrl:this.domainUrl,client_id:this.options.client_id,code_verifier:l.code_verifier,grant_type:"authorization_code",code:a,auth0Client:this.options.auth0Client},void 0!==l.redirect_uri&&(d.redirect_uri=l.redirect_uri),[4,L(d,this.worker)];case 1:return h=r.sent(),p=this._verifyIdToken(h.id_token,l.nonce,l.organizationId),f=n(n({},h),{decodedToken:p,audience:l.audience,scope:l.scope,client_id:this.options.client_id}),[4,this.cacheManager.set(f)];case 2:return r.sent(),this.cookieStorage.save("auth0.is.authenticated",!0,{daysUntilExpire:this.sessionCheckExpiryDays}),[2,{appState:l.appState}]}}))}))},e.prototype.checkSession=function(e){return o(this,void 0,void 0,(function(){var t;return r(this,(function(n){switch(n.label){case 0:if(!this.cookieStorage.get("auth0.is.authenticated"))return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.getTokenSilently(e)];case 2:return n.sent(),[3,4];case 3:if(t=n.sent(),!m.includes(t.error))throw t;return[3,4];case 4:return[2]}}))}))},e.prototype.getTokenSilently=function(e){return void 0===e&&(e={}),o(this,void 0,void 0,(function(){var t,o,s,a=this;return r(this,(function(r){return t=n(n({audience:this.options.audience,ignoreCache:!1},e),{scope:J(this.defaultScope,this.scope,e.scope)}),o=t.ignoreCache,s=i(t,["ignoreCache"]),[2,(c=function(){return a._getTokenSilently(n({ignoreCache:o},s))},u=this.options.client_id+"::"+s.audience+"::"+s.scope,l=ue[u],l||(l=c().finally((function(){delete ue[u],l=null})),ue[u]=l),l)];var c,u,l}))}))},e.prototype._getTokenSilently=function(e){return void 0===e&&(e={}),o(this,void 0,void 0,(function(){var t,s,a,c,u,l,d=this;return r(this,(function(h){switch(h.label){case 0:return t=e.ignoreCache,s=i(e,["ignoreCache"]),a=function(){return o(d,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:return[4,this.cacheManager.get(new z({scope:s.scope,audience:s.audience||"default",client_id:this.options.client_id}),60)];case 1:return[2,(e=t.sent())&&e.access_token]}}))}))},t?[3,2]:[4,a()];case 1:if(c=h.sent())return[2,c];h.label=2;case 2:return[4,(p=function(){return le.acquireLock(de,5e3)},f=10,void 0===f&&(f=3),o(void 0,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:e=0,t.label=1;case 1:return e<f?[4,p()]:[3,4];case 2:if(t.sent())return[2,!0];t.label=3;case 3:return e++,[3,1];case 4:return[2,!1]}}))})))];case 3:if(!h.sent())return[3,15];h.label=4;case 4:return h.trys.push([4,,12,14]),t?[3,6]:[4,a()];case 5:if(c=h.sent())return[2,c];h.label=6;case 6:return this.options.useRefreshTokens?[4,this._getTokenUsingRefreshToken(s)]:[3,8];case 7:return l=h.sent(),[3,10];case 8:return[4,this._getTokenFromIFrame(s)];case 9:l=h.sent(),h.label=10;case 10:return u=l,[4,this.cacheManager.set(n({client_id:this.options.client_id},u))];case 11:return h.sent(),this.cookieStorage.save("auth0.is.authenticated",!0,{daysUntilExpire:this.sessionCheckExpiryDays}),[2,u.access_token];case 12:return[4,le.releaseLock(de)];case 13:return h.sent(),[7];case 14:return[3,16];case 15:throw new b;case 16:return[2]}var p,f}))}))},e.prototype.getTokenWithPopup=function(e,t){return void 0===e&&(e={}),void 0===t&&(t={}),o(this,void 0,void 0,(function(){return r(this,(function(i){switch(i.label){case 0:return e.audience=e.audience||this.options.audience,e.scope=J(this.defaultScope,this.scope,e.scope),t=n(n({},p),t),[4,this.loginWithPopup(e,t)];case 1:return i.sent(),[4,this.cacheManager.get(new z({scope:e.scope,audience:e.audience||"default",client_id:this.options.client_id}))];case 2:return[2,i.sent().access_token]}}))}))},e.prototype.isAuthenticated=function(){return o(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.getUser()];case 1:return[2,!!e.sent()]}}))}))},e.prototype.buildLogoutUrl=function(e){void 0===e&&(e={}),null!==e.client_id?e.client_id=e.client_id||this.options.client_id:delete e.client_id;var t=e.federated,n=i(e,["federated"]),o=t?"&federated":"";return this._url("/v2/logout?"+T(n))+o},e.prototype.logout=function(e){var t=this;void 0===e&&(e={});var n=e.localOnly,o=i(e,["localOnly"]);if(n&&o.federated)throw new Error("It is invalid to set both the `federated` and `localOnly` options to `true`");var r=function(){if(t.cookieStorage.remove("auth0.is.authenticated"),!n){var e=t.buildLogoutUrl(o);window.location.assign(e)}};if(this.options.cache)return this.cacheManager.clear().then((function(){return r()}));this.cacheManager.clearSync(),r()},e.prototype._getTokenFromIFrame=function(e){return o(this,void 0,void 0,(function(){var t,o,s,a,c,u,l,d,h,p,f,m,v,g,w;return r(this,(function(r){switch(r.label){case 0:return t=K(C()),o=K(C()),s=C(),[4,U(s)];case 1:a=r.sent(),c=E(a),u=this._getParams(e,t,o,c,e.redirect_uri||this.options.redirect_uri||window.location.origin),l=this._authorizeUrl(n(n({},u),{prompt:"none",response_mode:"web_message"})),d=e.timeoutInSeconds||this.options.authorizeTimeoutInSeconds,r.label=2;case 2:return r.trys.push([2,5,,6]),[4,(S=l,I=this.domainUrl,k=d,void 0===k&&(k=60),new Promise((function(e,t){var n=window.document.createElement("iframe");n.setAttribute("width","0"),n.setAttribute("height","0"),n.style.display="none";var i,o=function(){window.document.body.contains(n)&&(window.document.body.removeChild(n),window.removeEventListener("message",i,!1))},r=setTimeout((function(){t(new b),o()}),1e3*k);i=function(n){if(n.origin==I&&n.data&&"authorization_response"===n.data.type){var s=n.source;s&&s.close(),n.data.response.error?t(y.fromPayload(n.data.response)):e(n.data.response),clearTimeout(r),window.removeEventListener("message",i,!1),setTimeout(o,2e3)}},window.addEventListener("message",i,!1),window.document.body.appendChild(n),n.setAttribute("src",S)})))];case 3:if(h=r.sent(),t!==h.state)throw new Error("Invalid state");return p=e.scope,f=e.audience,e.redirect_uri,e.ignoreCache,e.timeoutInSeconds,m=i(e,["scope","audience","redirect_uri","ignoreCache","timeoutInSeconds"]),[4,L(n(n(n({},this.customOptions),m),{scope:p,audience:f,baseUrl:this.domainUrl,client_id:this.options.client_id,code_verifier:s,code:h.code,grant_type:"authorization_code",redirect_uri:u.redirect_uri,auth0Client:this.options.auth0Client}),this.worker)];case 4:return v=r.sent(),g=this._verifyIdToken(v.id_token,o),[2,n(n({},v),{decodedToken:g,scope:u.scope,audience:u.audience||"default"})];case 5:throw"login_required"===(w=r.sent()).error&&this.logout({localOnly:!0}),w;case 6:return[2]}var S,I,k}))}))},e.prototype._getTokenUsingRefreshToken=function(e){return o(this,void 0,void 0,(function(){var t,o,s,a,c,u,l,d,h;return r(this,(function(r){switch(r.label){case 0:return e.scope=J(this.defaultScope,this.options.scope,e.scope),[4,this.cacheManager.get(new z({scope:e.scope,audience:e.audience||"default",client_id:this.options.client_id}))];case 1:return(t=r.sent())&&t.refresh_token||this.worker?[3,3]:[4,this._getTokenFromIFrame(e)];case 2:return[2,r.sent()];case 3:o=e.redirect_uri||this.options.redirect_uri||window.location.origin,a=e.scope,c=e.audience,e.ignoreCache,e.timeoutInSeconds,u=i(e,["scope","audience","ignoreCache","timeoutInSeconds"]),l="number"==typeof e.timeoutInSeconds?1e3*e.timeoutInSeconds:null,r.label=4;case 4:return r.trys.push([4,6,,9]),[4,L(n(n(n(n(n({},this.customOptions),u),{audience:c,scope:a,baseUrl:this.domainUrl,client_id:this.options.client_id,grant_type:"refresh_token",refresh_token:t&&t.refresh_token,redirect_uri:o}),l&&{timeout:l}),{auth0Client:this.options.auth0Client}),this.worker)];case 5:return s=r.sent(),[3,9];case 6:return"The web worker is missing the refresh token"===(d=r.sent()).message||d.message&&d.message.indexOf("invalid refresh token")>-1?[4,this._getTokenFromIFrame(e)]:[3,8];case 7:return[2,r.sent()];case 8:throw d;case 9:return h=this._verifyIdToken(s.id_token),[2,n(n({},s),{decodedToken:h,scope:e.scope,audience:e.audience||"default"})]}}))}))},e}();function ve(e){return o(this,void 0,void 0,(function(){var t;return r(this,(function(n){switch(n.label){case 0:return[4,(t=new me(e)).checkSession()];case 1:return n.sent(),[2,t]}}))}))}var ye=ve;return ye.Auth0Client=me,ye.createAuth0Client=ve,ye.GenericError=y,ye.AuthenticationError=g,ye.TimeoutError=b,ye.PopupTimeoutError=w,ye})),"Auth0Client"in this&&this.console&&this.console.warn&&this.console.warn("Auth0Client already declared on the global namespace"),this&&this.createAuth0Client&&(this.Auth0Client=this.Auth0Client||this.createAuth0Client.Auth0Client);
//# sourceMappingURL=auth0-spa-js.production.js.map
